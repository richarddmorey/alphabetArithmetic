---
title: "Alphabet arithmetic data"
author: "Richard D. Morey"
date: "6 July 2020"
output: 
  html_document:
    toc: true
    css: [ "include/css/github.css", 
           "include/css/aa_task.css" ]
    includes:
      in_header:  [ "include/html/include_js.html" ]
      after_body: [ "include/html/aa_task_js.html" ]
---


<a class="github-fork-ribbon" href="https://github.com/richarddmorey/alphabetArithmetic" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a>


```{r include=FALSE}
si = sessionInfo()
```
*This document was compiled under `r si$R.version$version.string` on `r lubridate::now()` (`r  Sys.timezone()`).*

# Experiment


Participants performed an "alphabet arithmetic" task, judging whether equations such as `A+3=D` were true or false. The letters represented numbers according to their position in the English alphabet (i.e. "A" is 1, "B" is 2, etc).

<div id="aa_demo">
  <span id="stimulus"></span>
  <div id="true"></div>
</div>

You can try an example of the task by moving your mouse into the blue area above and clicking once. Then, press the `z`  key to indicate that the equation is *true* and press the `/` key to indicate that the equation is *false*. The screen will turn green and a rising tone with sound for a correct answer; the screen will turn red and a single low tone will sound for an incorrect answer.[^screencolor]

[^screencolor]: In the actual task, the screen background color did not change; the background screen color change was added to the demonstration for accessibility reasons.


## Stimuli

Stimuli were mixed letter/number addition equations, where the first addend was a captital Roman letter (eight possibilities, from "A" to "H"), the second addend was a digit (five possibilities, from "1" through "5"), and the displayed sum was again a letter (fourteen possibilities, from "A" to "N").

40 possible true equations were generated by pairing each of the eight addend letters with each of the five addend numbers. The equation `A+3=D` is true.

80 possible false equations were generated by taking the true equations and either adding one (eg, `A+3=E`) or subtracting one (eg, `A+3=C`) from the true sum.


### Repetition of selected stimuli

Repeated equations were selected in the following way.

* **True equations**: Of the 40 possible true equations, *five* were selected at random for repeating, with uniform probability, without replacement. The only constraint was that each addend (1-5) had to be represented exactly once.

* **False equations**: Of the 80 possible false equations, *five* were selected at random for repeating, with uniform probability, without replacement. The only constraint was that each addend (1-5) had to be represented exactly once.


Of the total 120 possible equations, 10 were repeated 20 times. Thus, the total number of trials in the experiment was 
\[
110 + 20\times10 = 310.
\]

Note that this means that 
\[
  \frac{(35 + 20\times5)}{310} = 43.5\%
\]
of trials contain a true equation.


### Order of presentation 

The order of presentation was a randomly and uniformly selected permutation of the 310 trials. There were no other constraints, which means, for instance, that a participant could see the same repeated stimulus twice in a row.


## Experimental procedure

Participants give informed consent and were given instructions on how to determine whether a given equation was true or false, and that pressing `z` or `/` indicated true or false equations, respectively. They were asked to be as accuracy as possible. After the briefing, participants were then seated at a lab computer. Upon pressing a key to indicate that they were ready to start the task, they began judging equations.  

* Correct responses were followed by two quick, high-frequency tones, the second one octave above the other.
* Incorrect responses were followed by slow buzzing sound.
* Invalid key presses were followed by a slow buzzing sound and the words "`invalid key`" on the screen.
* Regardless of correctness, responses faster than 200ms were followed by a slow buzzing sound and the words "`too fast`" on the screen. After five responses faster than 200ms, the experiment was terminated prematurely.


# Data

The data were collected in the mid-2000s in [Jeff Rouder](https://www.faculty.uci.edu/profile.cfm?faculty_id=6493)'s Perception and Cognition lab at the University of Missouri as part of [Jun Lu's](https://www.american.edu/cas/faculty/lu.cfm) PhD dissertation work in Statistics. [Richard Morey](https://www.cardiff.ac.uk/people/view/1156534-morey-richard) wrote the experimental program and managed data collection with the help of undergraduate lab assistants.

Each data file is space delimited and has 13 columns, with no header. The 13 columns are described below:

| Col. # | Prefix | Description |
|-------:|:-------|:------------|
| 1      | `sub`  | Participant id |
| 2      | `sex`  | sex/gender (female = 0, male = 1) [I believe we asked about sex, not gender ---RDM] |
| 3      | `trl`  | trial number (integer, 0 - 309) |
| 4      | `let`  | First addend in equation (integer 1-8, indicating letters A-H) |
| 5      | `add`  | Second addend in equation (integer 1-5) |
| 6      | `sum`  | First addend in equation (integer 1-14, indicating letters A-N) |
| 7      | `id`   | Unique id for the stimulus (integer 0-119, indicating equations "A+1=A" to "H+5=N") |
| 8      | `tru`  | Is the equation true? (integer, 0 = false, 1 = true) |
| 9      | `isr`  | Was the stimulus chosen to repeat for this participant? (integer, 0 = non-repeat, 1 = repeat) |
| 10     |        | How many times has this stimulus been shown, including on this trial? (integer)
| 11     | `rsp`  | Response of the participant (integer, 0 = "false", 1 = "true")
| 12     |        | Whether the response was correct (integer, 0 = incorrect, 1 = correct) |
| 13     |        | Response time in milliseconds (integer; the few negative RTs are invalid trials)


Each row represents an individual trial.


```{r include=FALSE}

library(dplyr)

here::here("data") %>%
  dir(full.names = TRUE) %>%
  length() -> n_files

```

Each participant's data is in a separate file. There are data files for $N=`r n_files`$ participants. Participants who did not complete the task have been omitted. The files are given as they were originally written.

You can read the data into R and do some initial tidying with the following code:

```{r}
## The following code requires the R libraries
#   here
#   dplyr
#   readr
#   purrr
#   glue
##

here::here("data") %>%
  dir(full.names = TRUE) %>%
  purrr::map_df(readr::read_delim, delim = " ",
                col_names = c("id", "sex", "trial", "letter", "addend", "sum", 
                              "stim_id", "is_true", "is_repeat", "repeat_num", 
                              "response", "correct", "rt"),
                col_types = c(
                  correct = readr::col_integer()
                )
  ) %>%
  mutate(
    # Make the response times numeric
    rt = as.numeric(rt),
    # Make the repeat counts integers
    repeat_num = as.integer(repeat_num),
    # get rid of the prefixes
    across(where(is.character), gsub, pattern = "[a-zA-Z]", repl = ""),
    # turn everything else into integers
    across(where(is.character), as.integer),
    # create clearer factors where necessary
    id = factor(id),
    sex = factor(sex, labels = c("female","male")),
    letter_chr = factor(LETTERS[letter], ordered = TRUE),
    sum_chr = factor(LETTERS[sum], ordered = TRUE),
    equation_chr = factor(glue::glue("{letter_chr}+{addend}={sum_chr}"))
  ) -> aa

```


Upon reading in the data, you should have data from $310\times`r n_files`=`r format(310*n_files)`$ individual trials.

The table below shows all the data as it should appear after the above tidying steps.


```{r message=FALSE, echo=FALSE, warning=FALSE}
aa %>%
  DT::datatable(
    filter = 'top',
    options = list(
      scrollX = TRUE
    )
  )
```

For convenience, you can use the download button below to download the tidied version of the dataset in CSV format.

```{r echo=FALSE}

tf = tempfile(fileext = ".csv")

aa %>%
  readr::write_csv(path = tf)

downloadthis::download_file(
  path = tf,
  output_name = "alphabet_arithmetic",
  button_label = "Download tidied data",
  button_type = "warning",
  has_icon = TRUE,
  icon = "fa fa-save"
  )
```


<!--
Task javascript will be inserted here
-->
